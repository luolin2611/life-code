<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.lifecode.recordaccount.mapper.classify.ClassifyMapper">
    <resultMap id="classify" type="cn.lifecode.recordaccount.entity.Classify">
        <result column="classify_id" property="classifyId"/>
        <result column="classify_name" property="classifyName"/>
        <result column="add_type" property="addType"/>
        <result column="type" property="type"/>
        <result column="icon_id" property="iconId"/>
        <result column="user_id" property="userId"/>
        <result column="sort" property="sort"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updatTime"/>
    </resultMap>

    <!-- 添加分类 -->
    <insert id="addClassify" parameterType="cn.lifecode.recordaccount.entity.Classify" keyProperty="classify_id"
            useGeneratedKeys="true">
        insert into `record_account`.`classify` (`classify_name`, `add_type`, `type`, `icon_id`, `user_id`, `sort`,
                                                 `create_time`, `updat_time`)
        values (#{classify.classifyName},
                #{classify.addType},
                #{classify.type},
                #{classify.iconId},
                #{classify.userId},
                #{classify.sort},
                #{classify.createTime},
                #{classify.updatTime});
    </insert>

    <!-- 根据分类名称查询分类对象 -->
    <select id="selectClassifyByClassifyName" parameterType="string"
            resultMap="classify">
        select *
        from `record_account`.`classify`
        where classify_name = #{classifyName}
    </select>

    <!-- 根据userId 和 支付类型查询当前排序顺序 -->
    <select id="querySortByUserIdAndType" resultType="int">
        SELECT sort
        from classify
        WHERE user_id = #{userId}
          and `type` = #{type}
        order by sort desc limit 1;
    </select>

</mapper>
